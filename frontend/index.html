<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Optimasi Rute Rumah Sakit Kupang</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <link rel="stylesheet" href="styles.css" />
</head>

<body>

  <header>
    <h1>Optimasi Rute Antar Rumah Sakit di Kota Kupang</h1>
    <p class="header-subtitle">Menggunakan Algoritma Floyd-Warshall untuk All-Pairs Shortest Path</p>
  </header>

  <div class="controls">
    <div class="control-row">
      <div class="control-group">
        <label for="locationMode">Mode:</label>
        <select id="locationMode">
          <option value="hospital">Antar Rumah Sakit</option>
          <option value="custom">Dari Alamat Saya</option>
        </select>
      </div>
      
      <div id="hospitalModeControls" class="control-group">
        <label for="fromLocation">Dari RS:</label>
        <select id="fromLocation"></select>
      </div>
      
      <div id="customModeControls" class="control-group hidden">
        <label for="customAddress">Alamat Lengkap:</label>
        <input type="text" id="customAddress" placeholder="Contoh: Jl. Timor Raya No.15, Kelapa Lima, Kota Kupang" class="address-input">
        <button id="btnGeocodeAddress" class="btn-geocode">ğŸ“ Cari Lokasi</button>
      </div>
      
      <div class="control-group">
        <label for="targetRS">Ke RS:</label>
        <select id="targetRS"></select>
      </div>
    </div>
    
    <div class="control-row button-row">
      <button id="btnHitung" class="btn-primary">ğŸš— Hitung Rute Tercepat</button>
      <button id="btnReset" class="btn-secondary">ğŸ”„ Reset</button>
      <button id="btnShowGraph" class="btn-info">ğŸ“Š Graf Berarah</button>
      <button id="btnShowMatrix" class="btn-info">ğŸ“‹ Matriks</button>
      <button id="btnShowAllPairs" class="btn-info">ğŸ“‘ Semua Jalur</button>
    </div>
    
    <div id="customLocationInfo" class="custom-info hidden">
      <span class="info-icon">ğŸ“</span>
      <span id="customLocationName"></span>
    </div>
    
    <div id="addressHelpText" class="help-text hidden">
      <strong>ğŸ’¡ Tips Pencarian Alamat:</strong><br>
      â€¢ Gunakan nama landmark/tempat terkenal: <em>"Flobamora Mall"</em>, <em>"Universitas Nusa Cendana"</em>, <em>"Terminal Oebobo"</em><br>
      â€¢ Gunakan nama jalan utama: <em>"Jl. El Tari"</em>, <em>"Jl. Timor Raya"</em>, <em>"Jl. Soeharto"</em><br>
      â€¢ Atau alamat lengkap: <em>"Jl. El Tari No.88, Oebobo"</em>
    </div>
  </div>

  <div id="loading" class="loading hidden">
    <div class="spinner"></div>
    <p>Memuat data...</p>
  </div>

  <div id="notification" class="notification hidden"></div>

  <div id="routeInfo" class="route-info hidden">
    <h3>Informasi Rute</h3>
    <div id="routeDetails"></div>
  </div>

  <div id="matrixModal" class="modal hidden">
    <div class="modal-content">
      <span class="close-modal" id="closeMatrix">&times;</span>
      <h3>Matriks Hasil Floyd-Warshall</h3>
      <div class="matrix-tabs">
        <button class="tab-btn active" data-tab="distance">Jarak (km)</button>
        <button class="tab-btn" data-tab="duration">Waktu (menit)</button>
      </div>
      <div class="matrix-legend">
        <span><span class="legend-box direct"></span> Jalur langsung</span>
        <span><span class="legend-box indirect"></span> Jalur tidak langsung (lebih pendek)</span>
      </div>
      <div id="matrixContainer" class="matrix-container"></div>
    </div>
  </div>

  <div id="allPairsModal" class="modal hidden">
    <div class="modal-content">
      <span class="close-modal" id="closeAllPairs">&times;</span>
      <h3>Tabel Semua Jalur Terpendek (All-Pairs Shortest Path)</h3>
      <div class="matrix-tabs">
        <button class="tab-btn active" data-tab="distance">Berdasarkan Jarak</button>
        <button class="tab-btn" data-tab="duration">Berdasarkan Waktu</button>
      </div>
      <div id="allPairsContainer" class="all-pairs-container"></div>
    </div>
  </div>

  <div id="graphModal" class="modal hidden">
    <div class="modal-content modal-large">
      <span class="close-modal" id="closeGraph">&times;</span>
      <h3>Visualisasi Graf Berarah - Algoritma Floyd-Warshall</h3>
      <div class="matrix-tabs">
        <button class="tab-btn active" onclick="updateGraphMode('weighted')">Graf Berbobot</button>
        <button class="tab-btn" onclick="updateGraphMode('default')">Graf Sederhana</button>
        <button class="tab-btn" onclick="updateGraphMode('path')">Highlight Jalur</button>
      </div>
      <canvas id="graphCanvas" class="graph-canvas"></canvas>
      <div class="graph-explanation">
        <h4>Penjelasan Graf:</h4>
        <ul>
          <li><strong>Node (Lingkaran):</strong> Setiap Rumah Sakit dengan ID unik</li>
          <li><strong>Edge (Garis):</strong> Koneksi langsung antar RS dengan bobot jarak</li>
          <li><strong>Panah:</strong> Menunjukkan arah (graf berarah)</li>
          <li><strong>Warna:</strong> Klasifikasi berdasarkan jenis jalan (arteri primer/sekunder/lokal)</li>
          <li><strong>Floyd-Warshall:</strong> Mencari jalur terpendek melalui semua kemungkinan node perantara</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="legend">
    <h4>Legenda</h4>
    <div class="legend-item">
      <span class="marker-red"></span>
      <span>RS di Jalan Arteri Primer</span>
    </div>
    <div class="legend-item">
      <span class="marker-orange"></span>
      <span>RS di Jalan Arteri Sekunder</span>
    </div>
    <div class="legend-item">
      <span class="marker-blue"></span>
      <span>RS di Jalan Lokal</span>
    </div>
    <div class="legend-item">
      <span class="line-route"></span>
      <span>Rute Tercepat</span>
    </div>
  </div>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script src="floydWarshall.js"></script>
  <script src="graphVisualization.js"></script>
  <script src="app.js"></script>

</body>
</html>